# CLA Reports Style Guide

**Version: 0.92.0-Beta**
**Date: 2025-10-11**

---
### --- Revision History ---
## [0.92.0-Beta] - 2025-10-12
### Added
# - Added Section 5 to establish `GridSpec` as the best practice for
#   creating complex, multi-element plot layouts.
## [0.91.0-Beta] - 2025-10-11
### Changed
# - Clarified that `prettytable` is the "recommended standard" for
#   complex text reports, not a "required standard".
## [0.90.12-Beta] - 2025-10-06
### Changed
# - Standardized the report title format to the two-line "blended"
#   format, codifying the common implementation from plot reports.
## [0.86.5-Beta] - 2025-09-15
### Changed
# - Updated the Report Titles section to allow for a more flexible
#   three-line format, aligning the guide with the actual codebase.
## [0.54.0-Beta] - 2025-08-28
### Changed
# - Updated Section 3.1 (Table Formatting) to recommend `prettytable`
#   for complex reports, aligning it with Protocol 5.4.
## [0.52.14-Beta] - 2025-08-26
### Changed
# - Revised and standardized the report title format to a new,
#   mandatory two-line structure for all report types.
## [0.51.0-Beta] - 2025-08-26
### Added
# - Initial release of the official CLA Reports Style Guide.
# - Added standards for report titles, text reports (tabulate), and
#   HTML reports (Tailwind CSS, borders, centering).
---

## 1. Introduction
This document is the single source of truth for the visual and formatting standards of all report outputs generated by the Contest Log Analyzer. Its purpose is to ensure that all reports, regardless of type, have a consistent, clean, and professional appearance. All new reports must adhere to these guidelines.

---
## 2. Report Titles
All generated reports, regardless of their output format (text, plot, chart, animation, or HTML), must use the standard **two-line "blended"** title format. This creates a consistent and professional header for all user-facing documents.

* **Line 1**: The report's official `report_name`, optionally followed by other relevant, short context (e.g., the metric, mode, or a page/part number).
* **Line 2**: A consolidated string containing the contest context and callsign(s), formatted as `YYYY ContestName EventID - Callsign(s)`. The `EventID` is only included if defined for the contest.

#### **Examples:**

* **Single Log Text Report:**
    > --- Score Summary ---
    > 2025 CQ World Wide DX CW - K1ABC

* **Comparative Plot with Metric and EventID:**
    > Cumulative Difference Plots - Points
    > 2025 NAQP CW AUG - K1ABC vs. W1XYZ

* **Multi-Part Comparative Plot:**
    > Comparative Band Activity Heatmap (Part 1 of 2)
    > 2025 WAE CW - K1ABC vs. W1XYZ
---
## 3. Text Reports (`.txt`)
This section defines the standards for all plain-text reports.

### 3.1. Table Formatting
The creation of text-based tables is governed by the following two-tool approach to ensure both simplicity for basic reports and robust control for complex layouts.

* **For Complex Reports, Use `prettytable`**: For any report that requires a fixed-width layout, precise column alignment, or the alignment and "stitching" of multiple tables, the **`prettytable`** library is the recommended standard. It offers direct, programmatic control over column widths, which is essential for complex layouts.
* **For Simple Reports, Use `tabulate`**: For reports that require only a single, standalone table where complex alignment with other elements is not a concern, the simpler **`tabulate`** library is a suitable alternative.
---
## 4. HTML Reports (`.html`)
This section defines the standards for all web-based reports. The goal is to create modern, responsive, and visually appealing documents.

### 4.1. Styling Framework
All styling for HTML reports must be implemented using **Tailwind CSS**. No custom CSS in `<style>` blocks should be used unless absolutely necessary for a feature that Tailwind cannot support.

### 4.2. Table Styling
HTML tables should be styled to be clean, readable, and visually hierarchical.

* **Centering**: All tables must be centered horizontally on the page.
* **Border Hierarchy**: A two-level border system must be used to structure the data visually:
    * **Dark Lines** (`border-gray-500`): Used for the main outline of the table and for major vertical divisions between logical data groups.
    * **Medium Lines** (`border-gray-400`): Used for all internal grid lines, both horizontal and vertical.
---
## 5. Plot and Chart Layouts

### 5.1. Standard for Complex Layouts: Use GridSpec

For any plot or chart that consists of more than a simple title and a single subplot, developers **must consider** using Matplotlib's `GridSpec` to create an explicit, multi-zone layout.

**Rationale:** Automatic layout managers like `tight_layout` can become unpredictable when dealing with complex figures that include multi-line main titles, multiple subplots, and separate legends. Relying on them often leads to a frustrating "spiral of tweaks" to fix element overlap. Using `GridSpec` provides direct, predictable, and robust control over the final layout.

**Implementation Pattern:** The recommended approach is to create a main grid that divides the figure into distinct, non-overlapping "zones" for the title, the main plot area, and the legend. A nested `GridSpec` can then be used to arrange the plots within their dedicated zone.

**Example: A Three-Zone Layout**
This boilerplate creates a balanced layout with a reserved space for a main title, a central area for two side-by-side plots, and a dedicated space at the bottom for a legend.

```python
import matplotlib.pyplot as plt
import matplotlib.gridspec as gridspec

fig = plt.figure(figsize=(20, 11))

# --- Main 3-Row GridSpec Layout (Title, Plots, Legend) ---
gs_main = gridspec.GridSpec(
    3, 1,
    figure=fig,
    height_ratios=[1, 10, 1.5], # Allocate space: 1 for title, 10 for plots, 1.5 for legend
    top=0.93,      # Reduce top margin
    bottom=0.12    # Reduce bottom margin
)

# --- Create the zones ---
ax_title = fig.add_subplot(gs_main[0])
ax_legend = fig.add_subplot(gs_main[2])
ax_title.axis('off')
ax_legend.axis('off')

# --- Place the title in its zone ---
ax_title.text(0.5, 0.5, "Line 1 of Title\nLine 2 of Title", ha='center', va='center')

# --- Create a nested grid for the plots in the middle zone ---
gs_plots = gridspec.GridSpecFromSubplotSpec(1, 2, subplot_spec=gs_main[1])
ax_left_plot = fig.add_subplot(gs_plots[0, 0])
ax_right_plot = fig.add_subplot(gs_plots[0, 1])

# --- Place the legend in its zone ---
ax_legend.legend(handles=[...], loc='center', ncol=...)

# ... rest of your plotting code ...
```